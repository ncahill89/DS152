---
title: "DS152 Introduction to Data Science (2)"
subtitle: "Assignment 7: Text Analysis"
author: "Prof. Niamh Cahill"
format: 
  html:
    embed-resources: true
    self-contained-math: true
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidytext)
```

## **Solutions** **\[Total = 20 Marks\]**

## Exercise

You are provided with a dataset containing customer reviews of a restaurant. Your task is to perform sentiment analysis on these reviews using the tidy text approach in R. The dataset is shown below.

```{r, echo = FALSE}
review_text <- 
c("This restaurant has amazing food and excellent service",
"The food was terrible, but the service was great",
"We had a wonderful experience dining here",
"The atmosphere was cozy, but the food was just average",
"The service was slow, and the food was cold",
"We will definitely be coming back again",
"The portions were small, but the flavors were outstanding")

review_df <- tibble(line = 1:7, review_text = review_text)
review_df
```

**(a)** Replace \[A\] and \[B\] in the code below to create a tidy text dataset that has one word per row. 

```{r, eval = FALSE}
review_words  <- review_df %>%
                    [A](word, [B])
```

```{r, echo = TRUE}
review_words <-  review_df %>%
                    unnest_tokens(word, review_text)
review_words
```

  - [A] = unnest_tokens
  
  - [B] = review_text 
  
  __[4 Marks]__
  
**(b)** We now want to remove "stop" words from the `reviews_words` dataset. We use the following code to do this:

```{r, message = FALSE}
review_words_rm_stop <-   review_words %>%
                            anti_join(get_stopwords(source = "smart")) 
review_words_rm_stop
```

**i.** Explain in your own words what this code is doing.

 - `anti_join` will match datasets based on a column name, in this case the word column. It will return all of the rows in the `review_words` dataset that don't have a match in the get_stopwords(source = "smart") dataset. __[4 Marks]__


**ii.** How many stop words were removed from the dataset?

  - 33 words were removed. There's 59 rows in the `review_words` data and only 26 in the `review_words_rm_stop` data.  __[2 Marks]__


**(c)** Now we're going to assign a sentiment to each word in the `review_words_rm_stop` dataset using the bing library. We use the following code to do this:

```{r, message = FALSE}
sentiment_review <- review_words_rm_stop %>%
                            inner_join(get_sentiments("bing")) 
sentiment_review
```

**i.** Explain in your own words what this code is doing.

  - `inner_join` will match and merge datasets based on a column name, in this case the word column. For rows  in `review_words_rm_stop` where the word has a match in `get_sentiments("bing")` the corresponding sentiment will be added to the `review_words_rm_stop` data.  __[2 Marks]__


**ii.** Were all words in the `review_words_rm_stop` found in the bing library? Give a reason for your answer.

 - No. Only 9 of the words were found in the `bing` library as there's only 9 rows in the `sentiment_review` data. __[2 Marks]__

**(d)**

Now we're going to assign a sentiment to each word in the `review_words_rm_stop` dataset using the afinn library. We use the following code to do this:

```{r, message = FALSE}
sentiment_review_afinn <- review_words_rm_stop %>%
                            inner_join(get_sentiments("afinn")) 
sentiment_review_afinn
```

**i.** How do the afinn and bing lexicons differ in their treatment of sentiment?

  - The afinn lexicons has a numerical scale for sentiment from -5 to 5 ranging from negative to neutral (0) to positive. __[2 Marks]__

**ii.** Do the conclusions about the overall sentiment of the review agree when using the bing and afinn lexicons, give a reason for your answer. __[4 Marks]__

Yes, 69% of the words are assigned a positive sentiment when using the bing lexicon and the sentiment score when using the afinn lexicon is 2.7, which is also indicative of an overall positive sentiment. 
